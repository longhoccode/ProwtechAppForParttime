{"ast":null,"code":"import _objectSpread from\"E:/5.FILE LINH TINH/CODESPACE/prowtech-app/frontend-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"E:/5.FILE LINH TINH/CODESPACE/prowtech-app/frontend-web/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";const _excluded=[\"id\"];// File: StaffListPage.jsx\nimport React,{useState,useEffect,useCallback}from\"react\";import{Link}from\"react-router-dom\";import api from\"../services/api\";import StaffDetailModal from\"../components/modal/StaffDetailModal\";import DataTable from\"../components/DataTable\";import LoadingMessage from\"../components/LoadingMessage\";import ErrorMessage from\"../components/ErrorMessage\";import FilterBar from\"../components/FilterBar\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function StaffListPage(){const[staffs,setStaffs]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(\"\");const[isModalOpen,setIsModalOpen]=useState(false);const[currentStaff,setCurrentStaff]=useState(null);// filter state\nconst[filters,setFilters]=useState({search:\"\"});// Fetch staff\nconst fetchStaffs=useCallback(async()=>{try{setLoading(true);setError(\"\");const response=await api.get(\"/staffs\");setStaffs(response.data.data);}catch(_unused){setError(\"Failed to fetch staff.\");}finally{setLoading(false);}},[]);useEffect(()=>{fetchStaffs();},[fetchStaffs]);const handleOpenCreateModal=()=>{setCurrentStaff(null);setIsModalOpen(true);};const handleOpenEditModal=staff=>{setCurrentStaff(staff);setIsModalOpen(true);};const handleSaveStaff=async staffData=>{try{if(staffData.id){const{id}=staffData,updateData=_objectWithoutProperties(staffData,_excluded);const response=await api.put(\"/staffs/\".concat(id),updateData);setStaffs(prev=>prev.map(s=>s.id===id?response.data.data:s));}else{const response=await api.post(\"/staffs\",staffData);setStaffs(prev=>[response.data.data,...prev]);}setIsModalOpen(false);}catch(_unused2){setError(staffData.id?\"Failed to update staff.\":\"Failed to create staff.\");}};// filter logic\nconst filteredStaffs=staffs.filter(staff=>{var _staff$phone_number,_filters$search$toLow,_staff$tax_id,_filters$search$toLow2;const matchSearch=staff.full_name.toLowerCase().includes(filters.search.toLowerCase())||((_staff$phone_number=staff.phone_number)===null||_staff$phone_number===void 0?void 0:_staff$phone_number.toLowerCase().includes((_filters$search$toLow=filters.search.toLowerCase())!==null&&_filters$search$toLow!==void 0?_filters$search$toLow:\"\"))||((_staff$tax_id=staff.tax_id)===null||_staff$tax_id===void 0?void 0:_staff$tax_id.toLowerCase().includes((_filters$search$toLow2=filters.search.toLowerCase())!==null&&_filters$search$toLow2!==void 0?_filters$search$toLow2:\"\"));return matchSearch;});return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"page-title\",children:\"Staff Management\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-lg\",onClick:handleOpenCreateModal,children:\"+ Add Staff\"})]}),/*#__PURE__*/_jsx(FilterBar,{filters:[{type:\"text\",name:\"search\",label:\"Search\",placeholder:\"Search by name, phone, or tax ID...\"}],values:filters,onChange:(name,value)=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}))}),loading&&/*#__PURE__*/_jsx(LoadingMessage,{message:\"Loading staff...\"}),/*#__PURE__*/_jsx(ErrorMessage,{message:error}),!loading&&!error&&/*#__PURE__*/_jsx(DataTable,{columns:[{label:\"Full Name\"},{label:\"Phone\"},{label:\"Tax ID\"},{label:\"Bank Account\"},{label:\"Bank Name\"},{label:\"Actions\",className:\"text-center\"}],data:filteredStaffs,renderRow:staff=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Link,{to:\"/staffs/\".concat(staff.id),className:\"link\",children:staff.full_name})}),/*#__PURE__*/_jsx(\"td\",{children:staff.phone_number||\"N/A\"}),/*#__PURE__*/_jsx(\"td\",{children:staff.tax_id||\"N/A\"}),/*#__PURE__*/_jsx(\"td\",{children:staff.bank_account_number||\"N/A\"}),/*#__PURE__*/_jsx(\"td\",{children:staff.bank_name||\"N/A\"}),/*#__PURE__*/_jsx(\"td\",{className:\"table-actions\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline btn-sm\",onClick:()=>handleOpenEditModal(staff),children:\"Edit\"})})]},staff.id)}),/*#__PURE__*/_jsx(StaffDetailModal,{isOpen:isModalOpen,onClose:()=>setIsModalOpen(false),onSave:handleSaveStaff,staff:currentStaff})]});}export default StaffListPage;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Link","api","StaffDetailModal","DataTable","LoadingMessage","ErrorMessage","FilterBar","jsx","_jsx","jsxs","_jsxs","StaffListPage","staffs","setStaffs","loading","setLoading","error","setError","isModalOpen","setIsModalOpen","currentStaff","setCurrentStaff","filters","setFilters","search","fetchStaffs","response","get","data","_unused","handleOpenCreateModal","handleOpenEditModal","staff","handleSaveStaff","staffData","id","updateData","_objectWithoutProperties","_excluded","put","concat","prev","map","s","post","_unused2","filteredStaffs","filter","_staff$phone_number","_filters$search$toLow","_staff$tax_id","_filters$search$toLow2","matchSearch","full_name","toLowerCase","includes","phone_number","tax_id","className","children","onClick","type","name","label","placeholder","values","onChange","value","_objectSpread","message","columns","renderRow","to","bank_account_number","bank_name","isOpen","onClose","onSave"],"sources":["E:/5.FILE LINH TINH/CODESPACE/prowtech-app/frontend-web/src/pages/StaffListPage.js"],"sourcesContent":["// File: StaffListPage.jsx\r\nimport React, { useState, useEffect, useCallback } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport api from \"../services/api\";\r\nimport StaffDetailModal from \"../components/modal/StaffDetailModal\";\r\nimport DataTable from \"../components/DataTable\";\r\nimport LoadingMessage from \"../components/LoadingMessage\";\r\nimport ErrorMessage from \"../components/ErrorMessage\";\r\nimport FilterBar from \"../components/FilterBar\";\r\n\r\nfunction StaffListPage() {\r\n  const [staffs, setStaffs] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [currentStaff, setCurrentStaff] = useState(null);\r\n\r\n  // filter state\r\n  const [filters, setFilters] = useState({ search: \"\" });\r\n\r\n  // Fetch staff\r\n  const fetchStaffs = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(\"\");\r\n      const response = await api.get(\"/staffs\");\r\n      setStaffs(response.data.data);\r\n    } catch {\r\n      setError(\"Failed to fetch staff.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchStaffs();\r\n  }, [fetchStaffs]);\r\n\r\n  const handleOpenCreateModal = () => {\r\n    setCurrentStaff(null);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleOpenEditModal = (staff) => {\r\n    setCurrentStaff(staff);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleSaveStaff = async (staffData) => {\r\n    try {\r\n      if (staffData.id) {\r\n        const { id, ...updateData } = staffData;\r\n        const response = await api.put(`/staffs/${id}`, updateData);\r\n        setStaffs((prev) => prev.map((s) => (s.id === id ? response.data.data : s)));\r\n      } else {\r\n        const response = await api.post(\"/staffs\", staffData);\r\n        setStaffs((prev) => [response.data.data, ...prev]);\r\n      }\r\n      setIsModalOpen(false);\r\n    } catch {\r\n      setError(staffData.id ? \"Failed to update staff.\" : \"Failed to create staff.\");\r\n    }\r\n  };\r\n\r\n  // filter logic\r\n  const filteredStaffs = staffs.filter((staff) => {\r\n    const matchSearch =\r\n      staff.full_name.toLowerCase().includes(filters.search.toLowerCase()) ||\r\n      staff.phone_number?.toLowerCase().includes(filters.search.toLowerCase() ?? \"\") ||\r\n      staff.tax_id?.toLowerCase().includes(filters.search.toLowerCase() ?? \"\");\r\n    return matchSearch;\r\n  });\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"page-header\">\r\n        <h2 className=\"page-title\">Staff Management</h2>\r\n        <button className=\"btn btn-primary btn-lg\" onClick={handleOpenCreateModal}>\r\n          + Add Staff\r\n        </button>\r\n      </div>\r\n\r\n      <FilterBar\r\n        filters={[\r\n          {\r\n            type: \"text\",\r\n            name: \"search\",\r\n            label: \"Search\",\r\n            placeholder: \"Search by name, phone, or tax ID...\",\r\n          },\r\n        ]}\r\n        values={filters}\r\n        onChange={(name, value) => setFilters((prev) => ({ ...prev, [name]: value }))}\r\n      />\r\n\r\n      {loading && <LoadingMessage message=\"Loading staff...\" />}\r\n      <ErrorMessage message={error} />\r\n\r\n      {!loading && !error && (\r\n        <DataTable\r\n          columns={[\r\n            { label: \"Full Name\" },\r\n            { label: \"Phone\" },\r\n            { label: \"Tax ID\" },\r\n            { label: \"Bank Account\" },\r\n            { label: \"Bank Name\" },\r\n            { label: \"Actions\", className: \"text-center\" },\r\n          ]}\r\n          data={filteredStaffs}\r\n          renderRow={(staff) => (\r\n            <tr key={staff.id}>\r\n              <td>\r\n                <Link to={`/staffs/${staff.id}`} className=\"link\">\r\n                  {staff.full_name}\r\n                </Link>\r\n              </td>\r\n              <td>{staff.phone_number || \"N/A\"}</td>\r\n              <td>{staff.tax_id || \"N/A\"}</td>\r\n              <td>{staff.bank_account_number || \"N/A\"}</td>\r\n              <td>{staff.bank_name || \"N/A\"}</td>\r\n              <td className=\"table-actions\">\r\n                <button\r\n                  className=\"btn btn-outline btn-sm\"\r\n                  onClick={() => handleOpenEditModal(staff)}\r\n                >\r\n                  Edit\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          )}\r\n        />\r\n      )}\r\n\r\n      <StaffDetailModal\r\n        isOpen={isModalOpen}\r\n        onClose={() => setIsModalOpen(false)}\r\n        onSave={handleSaveStaff}\r\n        staff={currentStaff}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default StaffListPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}